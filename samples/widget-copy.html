<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Widget Copy 复制 — WebCom Samples</title>
<script src="_base.js"></script>
</head>
<body>
<div class="page-wrap">
<h1>Copy — 文本复制</h1>
<p class="subtitle">将指定文本或 DOM 内容复制到剪贴板，支持纯文本和富文本（带格式）复制。</p>

<h2>1. copy — 复制纯文本</h2>
<div class="demo-block">
  <input id="copy-input" type="text" value="这是要复制的文本内容" style="width:280px;margin-right:.5em">
  <button id="btn-copy-text">复制</button>
  <div id="copy-result-1" class="result-box" style="margin-top:.8em"></div>
</div>
<pre class="code-block">import { copy } from '../src/Widget/Copy.js';

copy('要复制的文本', () => {
  Toast.show('复制成功');
});</pre>

<h2>2. copyFormatted — 复制富文本（保留格式）</h2>
<div class="demo-block">
  <div id="rich-content" style="padding:1em;background:#f8fafc;border:1px solid #e2e8f0;border-radius:6px">
    <b>项目列表</b>
    <ul style="margin:.5em 0 0 1.5em">
      <li>WebCom <em>组件库</em></li>
      <li>版本：<code>1.0.0</code></li>
      <li>许可：MIT</li>
    </ul>
  </div>
  <button id="btn-copy-rich" style="margin-top:.8em">复制富文本</button>
  <p style="font-size:.85em;color:#6b7280;margin-top:.4em">粘贴到 Word / 邮件等支持富文本的编辑器中</p>
  <div id="copy-result-2" class="result-box" style="margin-top:.4em"></div>
</div>
<pre class="code-block">import { copyFormatted } from '../src/Widget/Copy.js';

// 复制 DOM 节点的 innerHTML，保留 HTML 格式
copyFormatted(element.innerHTML, () => {
  console.log('复制成功（含格式）');
});</pre>

<h2>3. 复制表格数据</h2>
<div class="demo-block">
  <table id="copy-table" style="border-collapse:collapse;width:100%">
    <thead>
      <tr>
        <th style="border:1px solid #ddd;padding:6px 12px;background:#f1f5f9">姓名</th>
        <th style="border:1px solid #ddd;padding:6px 12px;background:#f1f5f9">部门</th>
        <th style="border:1px solid #ddd;padding:6px 12px;background:#f1f5f9">职级</th>
      </tr>
    </thead>
    <tbody>
      <tr><td style="border:1px solid #ddd;padding:6px 12px">Alice</td><td style="border:1px solid #ddd;padding:6px 12px">研发</td><td style="border:1px solid #ddd;padding:6px 12px">P6</td></tr>
      <tr><td style="border:1px solid #ddd;padding:6px 12px">Bob</td><td style="border:1px solid #ddd;padding:6px 12px">产品</td><td style="border:1px solid #ddd;padding:6px 12px">P5</td></tr>
      <tr><td style="border:1px solid #ddd;padding:6px 12px">Carol</td><td style="border:1px solid #ddd;padding:6px 12px">设计</td><td style="border:1px solid #ddd;padding:6px 12px">P5</td></tr>
    </tbody>
  </table>
  <button id="btn-copy-table" style="margin-top:.8em">复制表格（粘贴到 Excel）</button>
  <div id="copy-result-3" class="result-box" style="margin-top:.5em"></div>
</div>
<pre class="code-block">import { copyFormatted } from '../src/Widget/Copy.js';

copyFormatted(tableElement.outerHTML);</pre>

<h2>参数说明</h2>
<table class="param-table">
  <tr><th>函数</th><th>参数</th><th>说明</th></tr>
  <tr><td>copy(text, callback)</td><td>text: string, callback?: Function</td><td>复制纯文本到剪贴板</td></tr>
  <tr><td>copyFormatted(html, callback)</td><td>html: string, callback?: Function</td><td>复制 HTML 富文本，保留样式格式</td></tr>
</table>

<div class="note">
  <b>注意：</b>复制操作需要用户手势触发（点击事件），不能在非用户交互的代码中调用。
  在 HTTPS 环境下使用 Clipboard API；HTTP 环境会降级为 document.execCommand。
</div>
</div>

<script type="module">
import { copy, copyFormatted } from '../src/Widget/Copy.js';

// 1. 纯文本
document.getElementById('btn-copy-text').onclick = () => {
  const text = document.getElementById('copy-input').value;
  copy(text, () => {
    document.getElementById('copy-result-1').innerHTML = `✅ 已复制：<b>"${text}"</b>`;
  });
};

// 2. 富文本
document.getElementById('btn-copy-rich').onclick = () => {
  const el = document.getElementById('rich-content');
  copyFormatted(el.outerHTML, () => {
    document.getElementById('copy-result-2').textContent = '✅ 富文本已复制，请粘贴到支持富文本的编辑器中查看效果';
  });
};

// 3. 表格
document.getElementById('btn-copy-table').onclick = () => {
  const table = document.getElementById('copy-table');
  copyFormatted(table.outerHTML, () => {
    document.getElementById('copy-result-3').textContent = '✅ 表格已复制，可粘贴到 Excel / Word 中';
  });
};
</script>
</body>
</html>
