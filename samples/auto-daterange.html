<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Auto DateRange 日期范围 — WebCom Samples</title>
<script src="_base.js"></script>
</head>
<body>
<div class="page-wrap">
<h1>ACDateRangeSelector — 日期范围选择</h1>
<p class="subtitle">为两个相关的日期输入框绑定联动逻辑，确保开始日期不晚于结束日期。</p>

<h2>1. 日期范围（date 类型）</h2>
<div class="demo-block">
  <div data-component="daterange" style="display:flex;align-items:center;gap:.6em;flex-wrap:wrap">
    <div>
      <label style="font-size:.85em;color:#64748b;display:block;margin-bottom:.2em">开始日期</label>
      <input type="date" name="start_date" data-daterange-start>
    </div>
    <span style="margin-top:1.2em;color:#94a3b8">~</span>
    <div>
      <label style="font-size:.85em;color:#64748b;display:block;margin-bottom:.2em">结束日期</label>
      <input type="date" name="end_date" data-daterange-end>
    </div>
  </div>
</div>
<pre class="code-block">&lt;div data-component="daterange"&gt;
  &lt;input type="date" name="start_date" data-daterange-start&gt;
  &lt;input type="date" name="end_date" data-daterange-end&gt;
&lt;/div&gt;
&lt;!-- 选择开始日期后，结束日期最早值自动更新 --&gt;</pre>

<h2>2. 日期时间范围（datetime-local）</h2>
<div class="demo-block">
  <div data-component="daterange" style="display:flex;align-items:center;gap:.6em;flex-wrap:wrap">
    <div>
      <label style="font-size:.85em;color:#64748b;display:block;margin-bottom:.2em">开始时间</label>
      <input type="datetime-local" name="start_time" data-daterange-start>
    </div>
    <span style="margin-top:1.2em;color:#94a3b8">至</span>
    <div>
      <label style="font-size:.85em;color:#64748b;display:block;margin-bottom:.2em">结束时间</label>
      <input type="datetime-local" name="end_time" data-daterange-end>
    </div>
  </div>
</div>
<pre class="code-block">&lt;div data-component="daterange"&gt;
  &lt;input type="datetime-local" name="start" data-daterange-start&gt;
  &lt;input type="datetime-local" name="end" data-daterange-end&gt;
&lt;/div&gt;</pre>

<h2>3. 在查询表单中使用</h2>
<div class="demo-block">
  <form id="query-form" style="display:flex;gap:.8em;align-items:flex-end;flex-wrap:wrap">
    <div>
      <label style="font-size:.85em;color:#64748b;display:block;margin-bottom:.2em">关键词</label>
      <input type="text" name="keyword" placeholder="搜索关键词">
    </div>
    <div data-component="daterange" style="display:flex;align-items:flex-end;gap:.5em">
      <div>
        <label style="font-size:.85em;color:#64748b;display:block;margin-bottom:.2em">起始日期</label>
        <input type="date" name="date_from" data-daterange-start>
      </div>
      <span style="padding-bottom:.4em;color:#94a3b8">—</span>
      <div>
        <label style="font-size:.85em;color:#64748b;display:block;margin-bottom:.2em">截止日期</label>
        <input type="date" name="date_to" data-daterange-end>
      </div>
    </div>
    <button type="submit">查询</button>
  </form>
  <div id="query-result" class="result-box" style="margin-top:.8em"></div>
</div>
<pre class="code-block">&lt;form&gt;
  &lt;input type="text" name="keyword"&gt;
  &lt;div data-component="daterange"&gt;
    &lt;input type="date" name="date_from" data-daterange-start&gt;
    &lt;input type="date" name="date_to" data-daterange-end&gt;
  &lt;/div&gt;
  &lt;button type="submit"&gt;查询&lt;/button&gt;
&lt;/form&gt;</pre>

<h2>data-* 属性说明</h2>
<table class="param-table">
  <tr><th>属性</th><th>说明</th></tr>
  <tr><td>data-daterange-start</td><td>标记起始日期输入框</td></tr>
  <tr><td>data-daterange-end</td><td>标记结束日期输入框</td></tr>
</table>
<div class="note">
  <b>注意：</b>DateRangeSelector 会自动设置 min/max 约束：
  选择开始日期后，结束日期输入框的 min 值自动更新为开始日期；
  选择结束日期后，开始日期的 max 值自动更新为结束日期。
</div>
</div>

<script type="module">
import { ACComponent } from '../src/Auto/ACComponent.js';
import '../src/Auto/ACDateRangeSelector.js';
import { formSerializeJSON } from '../src/Lang/Form.js';

ACComponent.init(document.body);

document.getElementById('query-form').addEventListener('submit', (e) => {
  e.preventDefault();
  try {
    const data = formSerializeJSON(e.target);
    document.getElementById('query-result').textContent = '查询参数：' + JSON.stringify(data);
  } catch(err) {
    const fd = new FormData(e.target);
    const obj = {};
    fd.forEach((v,k) => obj[k] = v);
    document.getElementById('query-result').textContent = '查询参数：' + JSON.stringify(obj);
  }
});
</script>
</body>
</html>
