<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dialog 对话框 — WebCom Samples</title>
<script src="_base.js"></script>
</head>
<body>
<div class="page-wrap">
<h1>Dialog — 对话框</h1>
<p class="subtitle">基于原生 &lt;dialog&gt; 封装，支持 HTML 内容、iframe、确认框、输入框，支持模态/非模态、多层叠加。</p>

<h2>1. 普通对话框 <code>Dialog.show()</code></h2>
<div class="demo-block">
  <div class="gap">
    <button id="btn-basic">打开对话框</button>
    <button id="btn-no-title" class="secondary">无标题对话框</button>
    <button id="btn-wide">宽对话框 (800px)</button>
  </div>
</div>
<pre class="code-block">import { Dialog } from '../src/Widget/Dialog.js';

// 基础用法
Dialog.show('标题', '&lt;p&gt;这是内容区 HTML&lt;/p&gt;');

// 自定义宽度
Dialog.show('大对话框', '内容', { width: 800 });

// 带自定义按钮
const dlg = Dialog.show('用户表单', formHtml, {
  width: 500,
  buttons: [
    { title: '保存', class: Dialog.DLG_CLS_BTN, callback: () => {
      // 返回 false 阻止关闭
      return false;
    }},
    { title: '取消' }
  ],
  onClose: () => console.log('已关闭')
});</pre>

<h2>2. 确认对话框 <code>Dialog.confirm()</code></h2>
<div class="demo-block">
  <button id="btn-confirm">确认删除</button>
  <div id="confirm-result" class="result-box" style="margin-top:0.8em">点击按钮查看结果</div>
</div>
<pre class="code-block">Dialog.confirm('删除确认', '确定要删除该记录吗？此操作不可撤销。')
  .then(() =&gt; {
    console.log('用户点击了确认');
  })
  .catch(() =&gt; {
    console.log('用户取消了');
  });</pre>

<h2>3. 告警/通知 <code>Dialog.alert()</code></h2>
<div class="demo-block">
  <button id="btn-alert">显示告警</button>
</div>
<pre class="code-block">Dialog.alert('温馨提示', '您的账号今日登录次数已达上限，请明天再试。');</pre>

<h2>4. 输入框对话框 <code>Dialog.prompt()</code></h2>
<div class="demo-block">
  <button id="btn-prompt">输入名称</button>
  <div id="prompt-result" class="result-box" style="margin-top:0.8em">点击按钮查看结果</div>
</div>
<pre class="code-block">Dialog.prompt('重命名', { initValue: '当前名称' })
  .then(value =&gt; {
    console.log('输入值:', value);
  });</pre>

<h2>5. iframe 对话框 <code>Dialog.iframe()</code></h2>
<div class="demo-block">
  <button id="btn-iframe">打开 iframe 对话框</button>
</div>
<pre class="code-block">Dialog.iframe('外部页面', 'https://example.com', { width: 800, height: 500 });</pre>

<h2>6. 非模态对话框</h2>
<div class="demo-block">
  <button id="btn-no-modal">非模态对话框（可拖动到一旁）</button>
</div>
<pre class="code-block">Dialog.show('非模态对话框', '&lt;p&gt;此对话框不会阻断背景操作&lt;/p&gt;', { modal: false });</pre>

<div class="note">
  <strong>注意：</strong>存在模态对话框时，其他对话框自动进入禁用状态（变灰）。按 <kbd>Esc</kbd> 关闭最顶层可关闭的对话框。
</div>

<h2>参数说明</h2>
<table class="param-table">
  <tr><th>config 属性</th><th>类型</th><th>默认值</th><th>说明</th></tr>
  <tr><td><code>width</code></td><td>Number/String</td><td>500</td><td>对话框宽度（px 或 CSS 字符串）</td></tr>
  <tr><td><code>height</code></td><td>Number/String</td><td>auto</td><td>对话框高度</td></tr>
  <tr><td><code>modal</code></td><td>Boolean</td><td>true</td><td>是否模态（背景禁用）</td></tr>
  <tr><td><code>showTopCloseButton</code></td><td>Boolean</td><td>true</td><td>是否显示右上角关闭按钮</td></tr>
  <tr><td><code>showScreenToggleButton</code></td><td>Boolean</td><td>false</td><td>是否显示全屏切换按钮</td></tr>
  <tr><td><code>buttons</code></td><td>Array</td><td>[{title:'关闭'}]</td><td>底部按钮列表</td></tr>
  <tr><td><code>onClose</code></td><td>Function</td><td>null</td><td>关闭时回调</td></tr>
</table>
</div>

<script type="module">
import { Dialog, DLG_CLS_BTN } from '../src/Widget/Dialog.js';

document.getElementById('btn-basic').onclick = () => {
  Dialog.show('普通对话框', '<p>这是对话框内容区，支持任意 <b>HTML</b>。</p><p>对话框默认宽度 500px，带关闭按钮。</p>');
};

document.getElementById('btn-no-title').onclick = () => {
  Dialog.show('', '<p style="padding:1.5em">这是没有标题的对话框。</p>');
};

document.getElementById('btn-wide').onclick = () => {
  Dialog.show('宽对话框', '<p>宽度设置为 800px。</p>', { width: 800 });
};

document.getElementById('btn-confirm').onclick = () => {
  const res = document.getElementById('confirm-result');
  Dialog.confirm('删除确认', '确定要删除该记录吗？此操作不可撤销。')
    .then(() => { res.textContent = '✅ 用户点击了【确认】'; res.style.background='#f0fdf4'; })
    .catch(() => { res.textContent = '❌ 用户点击了【取消】'; res.style.background='#fef2f2'; });
};

document.getElementById('btn-alert').onclick = () => {
  Dialog.alert('温馨提示', '您的账号今日登录次数已达上限，请明天再试。');
};

document.getElementById('btn-prompt').onclick = () => {
  const res = document.getElementById('prompt-result');
  Dialog.prompt('重命名文件', { initValue: '旧文件名.txt', placeholder: '请输入新名称' })
    .then(value => { res.textContent = `✅ 用户输入："${value}"`; });
};

document.getElementById('btn-iframe').onclick = () => {
  Dialog.iframe('WebCom GitHub', 'https://github.com/sasumi/WebCom', { width: 900, height: 550 });
};

document.getElementById('btn-no-modal').onclick = () => {
  Dialog.show('非模态对话框', '<p style="padding:1em">可以点击背景，不会禁用其他元素。</p>', { modal: false });
};
</script>
</body>
</html>
